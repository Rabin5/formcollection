{% extends 'core/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}
  कोभिड-१९ विशेष लेखापरीक्षणको सिलसिलामा - Nepal Audit Management System
{% endblock title %}

{% block page_title %}
कोभिड-१९ विशेष लेखापरीक्षणको सिलसिलामा आन्तरिक मामिला तथा कानून मन्त्रालयले माग गरेको सूचना एवं जानकारी उपलव्ध गराउने प्रयोजनको लागि तयार गरेको प्रश्नावली एवं विवरण
{% endblock page_title %}

{% block page_actions %}
  <a class="btn btn-success btn-with-icon" id='create_collection'>
    <i class="ic-add"></i>
    प्रश्नावलीहरू भर्नुहोस्
  </a>
{% endblock page_actions %}

{% block content %}
<table class="table table-striped table-borderless">
  <thead>
    <tr>
      <th>#.</th>
      <th>State</th>
      <th>Status</th>
      <th class="text-right">कार्य</th>
    </tr>
  </thead>
  <tbody>
    {% for form_collection in form_collections %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ form_collection }}</td>
        <td>{{ form_collection.get_status_display }}</td>
        <td class="action">
          <a href="{% url 'internal_affairs_forms:update' form_collection.pk %}">
            <i class="ic-edit mr-2"></i>
          </a>
          <a data-remote="{% url 'internal_affairs_forms:delete' form_collection.pk %}"
            href="{% url 'internal_affairs_forms:delete' form_collection.pk %}" data-toggle="modal" data-target="#modalProdDelete">
            <i class="ic-delete"></i>
          </a>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock content %}

{% block extrascripts %}
<script>
    $(document).ready(function(){
    $('#create_collection').on('click', function(){
      fetch("{% url 'internal_affairs_forms:create' %}", {
        method: 'POST',
        dataType: "json",
        headers: { "X-CSRFToken": '{{csrf_token}}' },
      })
      .then(response => response.json())
      .then(data => {
        window.location.href = data.url
      })
      .catch(function(err){
          console.log(err);
      });
    })
})
</script>
{% endblock extrascripts %}